"use strict";(self.webpackChunkProject=self.webpackChunkProject||[]).push([[309],{309:(Z,u,r)=>{r.r(u),r.d(u,{AuthModule:()=>L});var l=r(6895),d=r(371),s=r(433),g=r(590),m=r(8505),n=r(1571),p=r(6845);function f(t,i){1&t&&(n.TgZ(0,"div"),n._uU(1,"Email is required"),n.qZA())}function h(t,i){1&t&&(n.TgZ(0,"div"),n._uU(1,"Email format is incorrect"),n.qZA())}function C(t,i){if(1&t&&(n.TgZ(0,"div",11),n.YNc(1,f,2,0,"div",12),n.YNc(2,h,2,0,"div",12),n.qZA()),2&t){const o=n.oxw();n.xp6(1),n.Q6J("ngIf",o.validateInput("email","required")),n.xp6(1),n.Q6J("ngIf",o.validateInput("email","pattern"))}}function v(t,i){1&t&&(n.TgZ(0,"div"),n._uU(1,"Password is required"),n.qZA())}function x(t,i){if(1&t&&(n.TgZ(0,"div",11),n.YNc(1,v,2,0,"div",12),n.qZA()),2&t){const o=n.oxw();n.xp6(1),n.Q6J("ngIf",o.validateInput("password","required"))}}function M(t,i){1&t&&(n.TgZ(0,"div",11)(1,"div"),n._uU(2,"Email or Password incorrect"),n.qZA()())}let P=(()=>{class t{constructor(o,e){this.formBuilder=o,this.authService=e,this.submitted=!1,this.isIncorrect=!1,this.form=this.formBuilder.group({email:["",[s.kI.required,s.kI.pattern("^[a-zA-Z0-9._%+-]+@(?:multilaneinc\\.com|htpsal\\.com|hazenlabs\\.com)$")]],password:["",s.kI.required]}),this.emailControl=this.form.get("email"),this.passwordControl=this.form.get("password")}validateInput(o,e){return this.form.controls[o].hasError(e)}onSubmit(){this.submitted=!0,this.form.invalid||this.authService.login({email:this.emailControl.value,password:this.passwordControl.value}).pipe((0,g.P)(),(0,m.b)(e=>{this.authService.userSubject.next(e),console.log("Login attempt")})).subscribe({next:e=>{this.authService.onLoginSuccess(e)},error:e=>{console.error("Login failed",e),this.isIncorrect=!0}})}}return t.\u0275fac=function(o){return new(o||t)(n.Y36(s.qu),n.Y36(p.e))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-login"]],decls:19,vars:11,consts:[[3,"ngClass"],["src","assets/ML_Logo_Original.png","alt","LOGO",3,"ngClass"],[1,"card-body"],[1,"form",3,"formGroup","ngSubmit"],[1,"emailInput"],["type","text","placeholder","Email","id","email","formControlName","email",3,"ngClass"],["class","error",4,"ngIf"],[1,"error-placeholder"],[1,"passwordInput"],["type","password","autocomplete","your-password","placeholder","Password","id","password","formControlName","password",3,"ngClass"],[1,"card-bottom"],[1,"error"],[4,"ngIf"]],template:function(o,e){1&o&&(n.TgZ(0,"div",0)(1,"div",0),n._UZ(2,"img",1),n.TgZ(3,"h2",0),n._uU(4,"Login"),n.qZA()(),n.TgZ(5,"div",2)(6,"form",3),n.NdJ("ngSubmit",function(){return e.onSubmit()}),n.TgZ(7,"div",4),n._UZ(8,"input",5),n.qZA(),n.YNc(9,C,3,2,"div",6),n._UZ(10,"div",7),n.TgZ(11,"div",8),n._UZ(12,"input",9),n.qZA(),n.YNc(13,x,2,1,"div",6),n._UZ(14,"div",7),n.TgZ(15,"div",10)(16,"button",0),n._uU(17,"Login"),n.qZA(),n.YNc(18,M,3,0,"div",6),n.qZA()()()()),2&o&&(n.Q6J("ngClass","loginCard"),n.xp6(1),n.Q6J("ngClass","card-header"),n.xp6(1),n.Q6J("ngClass","logo"),n.xp6(1),n.Q6J("ngClass","title"),n.xp6(3),n.Q6J("formGroup",e.form),n.xp6(2),n.Q6J("ngClass","email-input"),n.xp6(1),n.Q6J("ngIf",e.submitted||(null==e.emailControl?null:e.emailControl.touched)&&(null==e.emailControl?null:e.emailControl.invalid)),n.xp6(3),n.Q6J("ngClass","password-input"),n.xp6(1),n.Q6J("ngIf",e.submitted||(null==e.passwordControl?null:e.passwordControl.touched)&&(null==e.passwordControl?null:e.passwordControl.invalid)),n.xp6(3),n.Q6J("ngClass","loginButton"),n.xp6(2),n.Q6J("ngIf",e.submitted&&e.isIncorrect))},dependencies:[l.mk,l.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:[".loginCard[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);height:400px;width:400px;padding:20px;border-radius:10px;border:1px solid rgb(217,217,217);display:flex;flex-direction:column;justify-content:center;align-items:center}.card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.card-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{padding-top:10px;width:150px}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:32px;font-weight:lighter}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%}.card-bottom[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;width:100%;height:40%}.form[_ngcontent-%COMP%]{width:70%}.email-input[_ngcontent-%COMP%]{padding-left:25px;background:url(emailIcon.4cb5af7dcddb07ba.png) no-repeat scroll 7px 7px;background-size:22px}.password-input[_ngcontent-%COMP%]{padding-left:25px;background:url(1password-svgrepo-com.bce7df03411c6613.png) no-repeat scroll 7px 7px;background-size:22px}.emailInput[_ngcontent-%COMP%], .passwordInput[_ngcontent-%COMP%], .rankInput[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;font-size:15px}.emailInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%], .emailInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%], .passwordInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%], .passwordInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%], .rankInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%], .rankInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]{border-radius:6px;border:1px solid rgba(169,169,169,.5);padding:10px;margin:5px 0;text-indent:25px}.emailInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%]::placeholder, .emailInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]::placeholder, .passwordInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%]::placeholder, .passwordInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]::placeholder, .rankInput[_ngcontent-%COMP%]   .email-input[_ngcontent-%COMP%]::placeholder, .rankInput[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]::placeholder{color:#6669}.error[_ngcontent-%COMP%]{position:fixed;font-size:12px;color:red}.error-placeholder[_ngcontent-%COMP%]{height:20px}.loginButton[_ngcontent-%COMP%]{width:80%;padding:10px 0;color:#fff;background:#0E2443;border-radius:40px;cursor:pointer;border:none;transition:all .2s ease-in-out;margin-bottom:30px}.loginButton[_ngcontent-%COMP%]:hover{background:#1f5192}.loginButton[_ngcontent-%COMP%]:active{background:#0b1f36;transform:scale(.98);box-shadow:0 0 5px #0000004d}"]}),t})();var O=r(5657),k=r(8763);let w=(()=>{class t{constructor(o,e,c,a){this.authService=o,this.cookieService=e,this.tokenService=c,this.router=a}canActivate(o,e){if(console.log("Login guard activated"),!this.tokenService.tokensExist(this.cookieService.get("accessToken"),this.cookieService.get("refreshToken")))return!0;if(this.tokenService.isExpired(this.cookieService.get("refreshToken")))return this.authService.logout(),!0;let c={accessToken:this.cookieService.get("accessToken"),refreshToken:this.cookieService.get("refreshToken")};return this.tokenService.refreshTokens(c).subscribe({next:a=>{if(!a.accessToken||!a.refreshToken)throw new Error("Access token or refresh token not found");this.cookieService.set("accessToken",a.accessToken),this.cookieService.set("refreshToken",a.refreshToken),this.router.navigate(["/Admin/Grid"])},error:a=>{console.error("Refresh token failed",a),this.authService.logout()}}),!1}}return t.\u0275fac=function(o){return new(o||t)(n.LFG(p.e),n.LFG(O.N),n.LFG(k.B),n.LFG(d.F0))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const I=[{path:"LogIn",component:P,canActivate:[(t,i)=>(0,n.f3M)(w).canActivate(t,i)]}];let _=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[d.Bz.forChild(I),d.Bz]}),t})();var b=r(529),T=r(5412);let L=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[l.ez,s.u5,_,s.UX,b.JF,T.Is]}),t})()}}]);